import{J as U}from"./Button-caddf70d.js";import{J as B}from"./ConfirmationModal-747d8d1a.js";import{J as x}from"./DangerButton-0ca7bbd2.js";import{J as A}from"./DialogModal-08c723b0.js";import{J as S}from"./FormSection-f05163be.js";import{J as L}from"./Input-2cb00575.js";import{J as M}from"./Checkbox-0b804630.js";import{J as I}from"./InputError-1ce94fe9.js";import{J as F}from"./Label-715dcd10.js";import{J as N}from"./SecondaryButton-3445fa1d.js";import{J as R}from"./SectionBorder-30338fa4.js";import{J as W}from"./ValidationErrors-deb0d81a.js";import{M as O}from"./vue3-multiselect.umd.min-7dc826ba.js";import{T as P}from"./TextField-f2f734f3.js";import{j as q,c as z,w as d,r as m,o as f,f as c,t as a,b as s,a as r,i as k,v as y,d as h,g as D,F as g,n as G}from"./app-5577a803.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-5b92d53d.js";import"./SectionTitle-75c86d6b.js";/* empty css            */const K={components:{TextField:P,JetButton:U,JetConfirmationModal:B,JetDangerButton:x,JetDialogModal:A,JetFormSection:S,JetInput:L,JetCheckbox:M,JetInputError:I,JetLabel:F,JetSecondaryButton:N,JetSectionBorder:R,JetValidationErrors:W,Multiselect:O},props:{book_item:{Type:Object,default:null}},data(){return{errors:[],input_error:!0,accounts:[],form:[],editingMode:!1,showDialog:!1,tab_idx:1}},methods:{ShowDialog(){if(this.form=q({id:null,name:"",description:"",reference_code:"",accounting_book_id:"",transaction_date:"",debit:"",credit:"",status:"Draft",approved_by:null,accepted_by:null,rejected_by:null,rejection_reason:"",entries:[],activities:[],attachment:[]}),this.editingMode=this.book_item!=null,this.book_item!==null)Object.keys(this.book_item).forEach(e=>{this.form[e]=this.book_item[e]}),this.form.transaction_date=this.form.transaction_date.slice(0,16),this.form.activities.forEach(e=>{e.contribution_percentage=e.pivot.contribution_percentage,e.accounting_activity_id=e.id});else{var t=0;this.activities.forEach(e=>{e.status=="Active"&&t++}),this.activities.forEach(e=>{this.form.activities.push({accounting_activity_id:e.id,name:e.name,contribution_percentage:e.status=="Active"?Math.round(1e4/t)/100:0})})}this.showDialog=!0},CancelDlg(){this.showDialog=!1},submit(){var t=!1;if(this.form.entries.forEach(e=>{e.account==null&&(t=!0)}),t){swal({title:this.__("Invalid Input"),text:this.__("Please review the book entries"),icon:"error",dangerMode:!0});return}this.form.post(route("accounting.book.item.store",route().params.book),{preserveScroll:!0,onSuccess:()=>{this.showDialog=!1,setTimeout(()=>{window.location.reload()},500)},onerror:e=>{this.errors=e.response.data.errors}})},addEntry(){this.form.entries.push({account:null,name:"",code:"",debit:0,credit:0}),this.updateData()},deleteEntry(t){this.form.entries.splice(t,1),this.updateData()},updateData(){this.$nextTick(()=>{this.form.credit=0,this.form.debit=0;var t=0;this.form.entries.forEach(e=>{this.form.credit+=this.parse(e.credit),this.form.debit+=this.parse(e.debit)}),this.form.activities.forEach(e=>{t+=this.parse(e.contribution_percentage)}),this.input_error=this.form.credit!=this.form.debit||this.form.credit==0||t!=100})},nameWithCode({id:t,name:e}){return t+" - "+e},setContribution(t,e){var C=this.form.activities[t].contribution_percentage;if(this.form.activities[t].contribution_percentage=e,e==100&&this.form.activities.forEach(n=>{n.id!=this.form.activities[t].id&&(n.contribution_percentage=0)}),e==0){var v=0;this.form.activities.forEach(n=>{n.contribution_percentage>0&&v++});var o=C/v;this.form.activities.forEach(n=>{n.contribution_percentage>0&&(n.contribution_percentage+=o)})}this.updateData()},fileSelected(t){this.form.attachment=t.target.files[0]}},created(){axios.get(route("accounting.chart.json")).then(t=>{this.accounts=t.data}).catch(t=>{}),axios.get(route("accounting.activity.json")).then(t=>{this.activities=t.data}).catch(t=>{})}},Q={class:"flex items-center ms-0 mb-4 border-b border-gray-200"},X={class:"grid grid-cols-4 gap-4"},Y={class:"grid grid-cols-4 gap-4"},Z={class:"col-span-4 grid grid-cols-10 gap-0"},$={class:"col-span-5 ms-2"},ee={class:"col-span-2 ms-2"},te={class:"col-span-2 ms-2"},oe=r("div",{class:"col-span-1 ms-2"},null,-1),ie={class:"col-span-5 ms-2 text-xl m-auto"},se=r("div",null,null,-1),ne={class:"grid grid-cols-4 gap-4"},le={class:"col-span-4 grid grid-cols-10 gap-0"},ae={class:"col-span-10 ms-2 text-xl"},re={class:"col-span-6 ms-2 text-xl m-auto"},de={class:"flex items-center justify-end"};function ce(t,e,C,v,o,n){const J=m("jet-validation-errors"),u=m("jet-button"),_=m("TextField"),j=m("jet-label"),E=m("multiselect"),p=m("jet-input"),V=m("jet-danger-button"),w=m("jet-secondary-button"),T=m("jet-dialog-modal");return f(),z(T,{closeable:!1,show:o.showDialog,maxWidth:"2xl",onClose:e[14]||(e[14]=i=>o.showDialog=!1)},{title:d(()=>[c(a(t.__("Accounting Book Item Dialog")),1)]),content:d(()=>[s(J,{class:"mb-4"}),r("div",Q,[s(u,{onClick:e[0]||(e[0]=i=>o.tab_idx=1),disabled:o.tab_idx==1,isRounded:!1},{default:d(()=>[c(a(t.__("Basic Data")),1)]),_:1},8,["disabled"]),s(u,{onClick:e[1]||(e[1]=i=>o.tab_idx=2),disabled:o.tab_idx==2,isRounded:!1},{default:d(()=>[c(a(t.__("Entries")),1)]),_:1},8,["disabled"]),s(u,{onClick:e[2]||(e[2]=i=>o.tab_idx=3),disabled:o.tab_idx==3,isRounded:!1},{default:d(()=>[c(a(t.__("Contributions")),1)]),_:1},8,["disabled"])]),k(r("div",X,[s(_,{class:"col-span-2",modelValue:o.form.reference_code,"onUpdate:modelValue":e[3]||(e[3]=i=>o.form.reference_code=i),itemType:"text",itemLabel:t.__("Book Reference Code")},null,8,["modelValue","itemLabel"]),s(_,{class:"col-span-2",modelValue:o.form.transaction_date,"onUpdate:modelValue":e[4]||(e[4]=i=>o.form.transaction_date=i),itemType:"datetime-local",itemLabel:t.__("Transaction Date")},null,8,["modelValue","itemLabel"]),s(_,{class:"col-span-4",modelValue:o.form.name,"onUpdate:modelValue":e[5]||(e[5]=i=>o.form.name=i),itemType:"text",itemLabel:t.__("Name")},null,8,["modelValue","itemLabel"]),s(_,{class:"col-span-4",modelValue:o.form.description,"onUpdate:modelValue":e[6]||(e[6]=i=>o.form.description=i),itemType:"text",itemLabel:t.__("Book Description")},null,8,["modelValue","itemLabel"]),s(j,{class:"col-span-4",for:"attachment",value:t.__("Attachments")},null,8,["value"]),r("input",{type:"file",class:"mt-1 block w-full py-2 col-span-4",required:"",accept:".pdf",onInput:e[7]||(e[7]=i=>o.form.attachment=i.target.files[0])},null,32)],512),[[y,o.tab_idx==1]]),k(r("div",Y,[r("div",Z,[r("div",$,a(t.__("Account")),1),r("div",ee,a(t.__("Debit Amount")),1),r("div",te,a(t.__("Credit Amount")),1),oe,(f(!0),h(g,null,D(o.form.entries,(i,b)=>(f(),h(g,null,[s(E,{class:"col-span-5 mt-1",modelValue:i.account,"onUpdate:modelValue":l=>i.account=l,label:"name",options:o.accounts,"custom-label":n.nameWithCode,placeholder:t.__("Select Account")},null,8,["modelValue","onUpdate:modelValue","options","custom-label","placeholder"]),s(p,{type:"number",class:"col-span-2 mt-1","onUpdate:modelValue":[e[8]||(e[8]=l=>n.updateData(l)),l=>i.debit=l],modelValue:i.debit},null,8,["modelValue","onUpdate:modelValue"]),s(p,{type:"number",class:"col-span-2 mt-1","onUpdate:modelValue":[e[9]||(e[9]=l=>n.updateData(l)),l=>i.credit=l],modelValue:i.credit},null,8,["modelValue","onUpdate:modelValue"]),s(V,{onClick:l=>n.deleteEntry(b),class:"mt-1"},{default:d(()=>[c(a(t.__("Delete")),1)]),_:2},1032,["onClick"])],64))),256)),r("div",ie,a(t.__("Total")),1),s(p,{type:"number",class:"col-span-2 bg-gray-400",modelValue:o.form.debit,"onUpdate:modelValue":e[10]||(e[10]=i=>o.form.debit=i),disabled:!0},null,8,["modelValue"]),s(p,{type:"number",class:"col-span-2 bg-gray-400",modelValue:o.form.credit,"onUpdate:modelValue":e[11]||(e[11]=i=>o.form.credit=i),disabled:!0},null,8,["modelValue"]),se,s(u,{class:"ps-2 col-span-10 mt-1",onClick:n.addEntry,disabled:o.form.processing},{default:d(()=>[c(a(t.__("Add Entry")),1)]),_:1},8,["onClick","disabled"])])],512),[[y,o.tab_idx==2]]),k(r("div",ne,[r("div",le,[r("div",ae,a(t.__("Bussiness Activities Contriubtion Percentages")),1),(f(!0),h(g,null,D(o.form.activities,(i,b)=>(f(),h(g,null,[r("div",re,a(i.name),1),s(p,{type:"number",class:"col-span-2 mt-1","onUpdate:modelValue":[e[12]||(e[12]=l=>n.updateData(l)),l=>i.contribution_percentage=l],modelValue:i.contribution_percentage},null,8,["modelValue","onUpdate:modelValue"]),s(V,{onClick:l=>n.setContribution(b,100),class:"m-1 col-span-1"},{default:d(()=>[c(a(t.__("All")),1)]),_:2},1032,["onClick"]),s(V,{onClick:l=>n.setContribution(b,0),class:"m-1 col-span-1"},{default:d(()=>[c(a(t.__("None")),1)]),_:2},1032,["onClick"])],64))),256))])],512),[[y,o.tab_idx==3]])]),footer:d(()=>[r("div",de,[s(w,{onClick:e[13]||(e[13]=i=>n.CancelDlg())},{default:d(()=>[c(a(t.__("Cancel")),1)]),_:1}),s(u,{class:G(["ms-2",{"opacity-25":o.form.processing}]),onClick:n.submit,disabled:o.form.processing|o.input_error},{default:d(()=>[c(a(t.__("Save")),1)]),_:1},8,["onClick","class","disabled"])])]),_:1},8,["show"])}const Ue=H(K,[["render",ce]]);export{Ue as default};
