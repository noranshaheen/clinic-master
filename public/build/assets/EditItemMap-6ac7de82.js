import{J}from"./ActionMessage-517545cc.js";import{J as A}from"./ActionSection-2c866042.js";import{J as E}from"./Button-11813b5e.js";import{J as N}from"./ConfirmationModal-0f300aca.js";import{J as D}from"./DangerButton-367e534b.js";import{J as k}from"./DialogModal-22356253.js";import{J as w}from"./FormSection-bd296fee.js";import{J as B}from"./Input-8a286b7b.js";import{J as j}from"./Checkbox-ebdeef89.js";import{J as U}from"./InputError-317c03cf.js";import{J as M}from"./Label-e291ccc6.js";import{J as L}from"./SecondaryButton-8a1eaf86.js";import{J as F}from"./SectionBorder-822e764c.js";import{J as P}from"./ValidationErrors-31471297.js";import{M as W}from"./vue3-multiselect.umd.min-939aa207.js";import{k as f,c as g,w as m,r as d,o as h,f as u,t as i,b as a,a as l,d as T,g as R,F as x,e as q,h as z,n as O}from"./app-010fad37.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import"./SectionTitle-8abeab5a.js";import"./Modal-97755a3c.js";/* empty css            */const H={components:{JetActionMessage:J,JetActionSection:A,JetButton:E,JetConfirmationModal:N,JetDangerButton:D,JetDialogModal:k,JetFormSection:w,JetInput:B,JetCheckbox:j,JetInputError:U,JetLabel:M,JetSecondaryButton:L,JetSectionBorder:F,JetValidationErrors:P,Multiselect:W},props:{item_map:{Type:Object,default:null}},data(){return{errors:[],form:this.$inertia.form({SBCode:"",ETACode:"",ItemNameA:"",ItemNameE:"",taxTypes:[],Val_Diff:0}),eta_item:null,items:[],showDialog:!1,taxTypes:[],taxSubTypes:[],taxSubtypes1:[],taxType:null,taxSubtype:null}},methods:{ShowDialog(){this.item_map!==null&&(this.form.SBCode=this.item_map.SBCode,this.form.ETACode=this.item_map.ETACode,this.form.ItemNameA=this.item_map.ItemNameA,this.form.ItemNameE=this.item_map.ItemNameE,this.form.Val_Diff=this.item_map.Val_Diff,this.form.taxTypes=[],this.updateTaxList()),this.showDialog=!0,this.$nextTick(()=>{this.item_map!=null&&this.items!=null&&(this.eta_item=this.items.find(e=>e.itemCode===this.form.ETACode),this.updateETAItem())})},CancelDlg(){this.showDialog=!1},submit(){f.post(route("sb.items.map.update"),this.form).then(e=>{this.$store.dispatch("setSuccessFlashMessage",!0),this.processing=!1,this.form.reset(),this.form.processing=!1,this.showDialog=!1,setTimeout(()=>{window.location.reload()},500)}).catch(e=>{this.form.processing=!1,this.$page.props.errors=e.response.data.errors,this.errors=e.response.data.errors})},nameWithCode({codeNamePrimaryLang:e,codeNameSecondaryLang:t,itemCode:n}){return this.$page.props.locale=="ar"?n+" - "+t:n+" - "+e},updateETAItem(){this.eta_item&&((this.form.ItemNameA==null||this.form.ItemNameA.length<3)&&(this.form.ItemNameA=this.eta_item.codeNameSecondaryLang),(this.form.ItemNameE==null||this.form.ItemNameE.length<3)&&(this.form.ItemNameE=this.eta_item.codeNamePrimaryLang),this.form.ETACode=this.eta_item.itemCode)},updateTaxSubtypes(){this.taxSubtypes1=this.taxSubtypes.filter(e=>{if(e.TaxtypeReference==this.taxType.Code)return e}),this.taxSubType={}},AddTaxItem(e=0){this.form.taxTypes.push({taxType:this.taxType,taxSubtype:this.taxSubtype,percentage:e})},deleteItem(e){this.form.taxTypes.splice(e,1)},updateTaxList(){this.item_map.item_tax.forEach(e=>{this.taxType=this.taxTypes.find(t=>t.Code===e.taxType),this.taxSubtype=this.taxSubtypes.find(t=>t.Code===e.taxSubtype),this.AddTaxItem(e.rate)})}},created(){f.get(route("json.eta.items")).then(e=>{this.items=e.data,this.item_map!=null&&(this.eta_item=this.items.find(t=>t.itemCode===this.form.ETACode),this.updateETAItem())}).catch(e=>{}),f.get("/json/TaxTypes.json").then(e=>{this.taxTypes=e.data,this.taxTypes=this.taxTypes.map(t=>(t.label=t.Code.concat("(",t.Desc_ar,")"),t)),f.get("/json/TaxSubtypes.json").then(t=>{this.taxSubtypes=t.data,this.taxSubtypes=this.taxSubtypes.map(n=>(n.label=n.Code.concat("(",n.Desc_ar,")"),n)),this.updateTaxList()}).catch(t=>{})}).catch(e=>{})}},K={class:"grid grid-cols-2 gap-4"},Q={class:"col-span-1"},X={class:"col-span-1"},Y={class:"col-span-2"},Z={class:"col-span-1"},$={class:"col-span-1"},ee={class:"grid grid-cols-7 gap-2 mt-2 border-t border-b border-gray-20"},te={class:"flex items-center justify-center col-span-1"},se={class:"grid grid-cols-6 gap-0 mt-2"},oe={class:"bg-gray-200 col-span-2"},ae={class:"bg-gray-200 col-span-2"},le={class:"bg-gray-200 col-span-1"},ie=l("div",{class:"bg-gray-200 col-span-1"},null,-1),me={class:"flex items-center justify-end"};function re(e,t,n,ne,o,r){const S=d("jet-validation-errors"),p=d("jet-label"),c=d("jet-input"),_=d("multiselect"),y=d("jet-secondary-button"),C=d("jet-danger-button"),V=d("jet-button"),v=d("jet-dialog-modal");return h(),g(v,{show:o.showDialog,maxWidth:"3xl",onClose:t[10]||(t[10]=s=>o.showDialog=!1)},{title:m(()=>[u(i(e.__("Item Map")),1)]),content:m(()=>[a(S,{class:"mb-4"}),l("form",{onSubmit:t[8]||(t[8]=z((...s)=>r.submit&&r.submit(...s),["prevent"]))},[l("div",K,[l("div",Q,[a(p,{value:e.__("SBCode")},null,8,["value"]),a(c,{id:"SBCode",type:"text",class:"mt-1 block w-full",modelValue:o.form.SBCode,"onUpdate:modelValue":t[0]||(t[0]=s=>o.form.SBCode=s),disabled:!0},null,8,["modelValue"])]),l("div",X,[a(p,{value:e.__("Value Difference")},null,8,["value"]),a(c,{id:"ValDiff",type:"number",class:"mt-1 block w-full",modelValue:o.form.Val_Diff,"onUpdate:modelValue":t[1]||(t[1]=s=>o.form.Val_Diff=s)},null,8,["modelValue"])]),l("div",Y,[a(p,{value:e.__("ETACode")},null,8,["value"]),a(_,{modelValue:o.eta_item,"onUpdate:modelValue":[t[2]||(t[2]=s=>o.eta_item=s),r.updateETAItem],options:o.items,"custom-label":r.nameWithCode,label:"codeNamePrimaryLang","track-by":"itemCode",placeholder:e.__("Select item")},null,8,["modelValue","options","custom-label","onUpdate:modelValue","placeholder"])]),l("div",Z,[a(p,{value:e.__("Name Arabic")},null,8,["value"]),a(c,{id:"SBCode",type:"text",class:"mt-1 block w-full",modelValue:o.form.ItemNameA,"onUpdate:modelValue":t[3]||(t[3]=s=>o.form.ItemNameA=s)},null,8,["modelValue"])]),l("div",$,[a(p,{value:e.__("Name English")},null,8,["value"]),a(c,{id:"SBCode",type:"text",class:"mt-1 block w-full",modelValue:o.form.ItemNameE,"onUpdate:modelValue":t[4]||(t[4]=s=>o.form.ItemNameE=s)},null,8,["modelValue"])])]),l("div",ee,[a(_,{class:"col-span-3",modelValue:o.taxType,"onUpdate:modelValue":[t[5]||(t[5]=s=>o.taxType=s),r.updateTaxSubtypes],label:"label",placeholder:e.__("Select Tax Type"),options:o.taxTypes},null,8,["modelValue","placeholder","options","onUpdate:modelValue"]),a(_,{class:"col-span-3",modelValue:o.taxSubtype,"onUpdate:modelValue":t[6]||(t[6]=s=>o.taxSubtype=s),placeholder:e.__("Select Tax Subtype"),options:o.taxSubtypes1,label:"label"},null,8,["modelValue","placeholder","options"]),l("div",te,[a(y,{onClick:t[7]||(t[7]=s=>r.AddTaxItem())},{default:m(()=>[u(i(e.__("Add Tax")),1)]),_:1})])]),l("div",se,[l("div",oe,i(e.__("Tax Code")),1),l("div",ae,i(e.__("Tax Subcode")),1),l("div",le,i(e.__("Tax Percentage")),1),ie,(h(!0),T(x,null,R(o.form.taxTypes,(s,I)=>(h(),T(x,{key:s.key},[a(p,{class:"mt-2 col-span-2"},{default:m(()=>[u(i(s.taxType.label),1)]),_:2},1024),a(p,{class:"mt-2 col-span-2"},{default:m(()=>[u(i(s.taxSubtype.label),1)]),_:2},1024),a(c,{id:s.taxType.label,type:"number",class:"mt-1 block w-full mt-2 col-span-1",isRounded:!1,modelValue:s.percentage,"onUpdate:modelValue":b=>s.percentage=b,required:"",autofocus:""},null,8,["id","modelValue","onUpdate:modelValue"]),a(C,{onClick:b=>r.deleteItem(I),class:"mt-2 ms-2"},{default:m(()=>[u(i(e.__("Delete")),1)]),_:2},1032,["onClick"])],64))),128)),!o.form.taxTypes||o.form.taxTypes.length==0?(h(),g(p,{key:0,class:"col-span-8"},{default:m(()=>[u(i(e.__("Please Add tax items if applicable")),1)]),_:1})):q("",!0)])],32)]),footer:m(()=>[l("div",me,[a(y,{onClick:t[9]||(t[9]=s=>r.CancelDlg())},{default:m(()=>[u(i(e.__("Cancel")),1)]),_:1}),a(V,{class:O(["ms-2",{"opacity-25":o.form.processing}]),onClick:r.submit,disabled:o.form.processing},{default:m(()=>[u(i(e.__("Save")),1)]),_:1},8,["onClick","class","disabled"])])]),_:1},8,["show"])}const Ne=G(H,[["render",re]]);export{Ne as default};
